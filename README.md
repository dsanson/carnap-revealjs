# Carnap + Pandoc + Reveal.js

Embed [Carnap](https://carnap.io) exercises into a
[reveal.js](https://revealjs.com/) slideshow generated by
[pandoc](https://pandoc.org).

## What? Why?

-   I teach logic using Carnap.
-   I write my lecture slideshows in markdown, and use pandoc to convert them
    to an HTML slideshow powered by revealjs.
-   I want to be able to include exercises from Carnap in my slideshows.

## Alternatives

For a simpler option, see Graham's
[SlideTemplate](https://github.com/gleachkr/SlideTemplate).

I chose to try to do this with pandoc and revealjs because that was what I was
already using. But pandoc supports lots of different html slide show formats.
I suspect many of them are less invasive than revealjs, and might work fine
without any extra CSS kludges.

## How?

-   Write the slide show in markdown, following [these
    instructions](https://pandoc.org/MANUAL.html#producing-slide-shows-with-pandoc)
-   Include Carnap exercises (using the "raw" formats described below)
-   Set `carnap: true` in the slideshow's YAML metadata
-   Convert using pandoc and a custom template, which adds links to the appropriate CSS and JS files

## Example

To generate the `example.html` slide show:

```
git clone https://github.com/dsanson/carnap-revealjs
cd carnap-revealjs
pandoc -t revealjs example.md -o example.html --template carnap.revealjs -s --slide-level 2
```

Here is a [live version of the example
file](https://dsanson.github.io/carnap-revealjs/example.html).

## Template

The `carnap.revealjs` pandoc template is pandoc's default revealjs template
with a few lines added to the header:

```
$if(carnap)$
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans|Open+Sans&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dsanson/carnap-revealjs/css/carnap-revealjs.css">
  <link rel="stylesheet" href="https://carnap.io/static/css/exercises.css" />
  <link type='text/css' href='https://cdn.jsdelivr.net/gh/gleachkr/ProofJS@gh-pages/proof.css' rel='stylesheet'>
  <script src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0'></script>
  <script src='https://cdn.jsdelivr.net/gh/gleachkr/ProofJS@gh-pages/proof.js'></script>
  <script src='https://carnap.io/static/ghcjs/rts.js'></script>
  <script src='https://carnap.io/static/ghcjs/allactions/lib.js'></script>
  <script src='https://carnap.io/static/ghcjs/allactions/out.js'></script>
$endif$
```

and a few lines added just before the closing `</body>` tag:

```
$if(carnap)$
  <script src='https://carnap.io/static/ghcjs/allactions/runmain.js'></script>
$endif$
```

These are the CSS and JS files needed to load Carnap into the slideshow. 
The only thing here that isn't a standard part of Carnap is:

```
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dsanson/carnap-revealjs/css/carnap-revealjs.css">
```

which links to the latest version of
[carnap-revealjs.css](css/carnap-revealjs.css).

## Carnap Exercise Formats

You need to use the "raw" formats to include exercises. You can't use the
standard formats described
[here](https://carnap.io/shared/gleachkr@gmail.com/carnap-pandoc.pandoc). 

### Derivations 

```{.html}
<pre data-carnap-type="proofchecker"
           data-carnap-goal=":|-:((P->Q)->P)->P"
           data-carnap-submission="none"
           data-carnap-system="prop"
           data-carnap-guides="montague"
           data-carnap-options="fonts">
Show ((P -> Q)-> P) -> P
</pre>
```

Or, equivalently, using pandoc's attribute syntax:

````{.markdown}
```{carnap-goal=':|-:((P->Q)->P)->P' carnap-type='proofchecker' carnap-system='prop' carnap-guides='montague' carnap-options="fonts"}
Show ((P->Q)->P)->P
```
````

### Translations

```{.html}
<pre data-carnap-type="translate"
     data-carnap-goal="Ax(F(x)->G(x))"
     data-carnap-transtype="first-order"
     data-carnap-problem="every dog has his day"
     data-carnap-options="nocipher">Every dog has his day
</pre>
```


### Truth Tables

```{.html}
<pre data-carnap-type="truthtable"
           data-carnap-goal="~(P\/~P):|-:P/\~P"
           data-carnap-submission="none"
           data-carnap-options="hiddenGivens"
           data-carnap-tabletype="validity">
</pre>
```

### Partial Truth Tables

```{.html}
<pre data-carnap-type="truthtable"
           data-carnap-goal="~P/\~Q,~P\/~Q"
           data-carnap-submission="none"
           data-carnap-options="hiddenGivens"
           data-carnap-tabletype="partial">
           --T----F--
           --F----T--
</pre>
```

### Models

```{.html}`
<pre data-carnap-type="countermodeler"
     data-carnap-countermodelertype="validity"
     data-carnap-goal="AxEyF(x,y):|-:ExAyF(x,y)">
</pre>
```

### Sequent Calculus Proofs

```{.html}
<pre data-carnap-type="sequentchecker"
     data-carnap-goal="P->Q,Q->R:|-:P->R">
</pre>
```

### Gentzen-Prawitz Natural Deduction

```{.html}
<pre data-carnap-type="treedeductionchecker"
     data-carnap-goal="P->Q,Q->R:|-:P->R">
</pre>
```

### Multiple Choice Questions

```{.html}
<pre data-carnap-type="qualitative"
           data-carnap-goal="What's the answer to this question?"
           data-carnap-submission="none"
           data-carnap-options="nocipher check"
           data-carnap-qualitativetype="multiplechoice">
+yes
no
*I reject the whole premise of this question.
</pre>
```

# Issues

## CSS Problems

So far, I've just been using this with the 'moon' theme on reveal.js. Other
themes break things. (In the default theme, for example, derivation line
numbers are hidden.)

So far, the only CSS I've applied is to fix the vertical alignment of line
numbers and feedback in derivation exercises.

## Pandoc Input

It would be nice to avoid the "raw" format for adding exercises. Ideally, one
could cut and paste a problem from an assignment into a slideshow. I'm not
sure what the best way is to implement this. Some possibilities:

-   Add this feature to Carnap's client side processing
-   Create a pandoc filter that does this.

A filter that renames attributes and parses the "options" attribute seems
relatively trivial. The messier bit is parsing out the content. Seems a shame
to reinvent the wheel on this.

# Related

For another approach to creating slides that contain Carnap exercises, see
Graham's [SlideTemplate](https://github.com/gleachkr/SlideTemplate). 



